class ProductManager{constructor(){this.products=[],this.filteredProducts=[],this.currentCategory="all",this.currentPriceRange="all",this.searchQuery="",this.init()}init(){this.generateSampleProducts(),this.filteredProducts=[...this.products],this.renderProducts(),this.setupEventListeners()}generateSampleProducts(){this.products=[{id:1,name:"Смартфон Apple iPhone 14",description:"Новый флагманский смартфон с улучшенной камерой и производительностью.",price:79990,category:"smartphones",image:"images/iphonee.jpeg",inStock:!0,rating:4.8},{id:2,name:"Ноутбук Dell XPS 13",description:"Ультрабук с безрамочным дисплеем и мощным процессором Intel Core i7.",price:129990,category:"laptops",image:"images/dell xps.webp",inStock:!0,rating:4.6},{id:3,name:'Телевизор Samsung QLED 55"',description:"Телевизор с технологией QLED для реалистичного изображения и ярких цветов.",price:89990,category:"tvs",image:"images/Samsung telek.jpg",inStock:!0,rating:4.7},{id:4,name:"Наушники Sony WH-1000XM4",description:"Беспроводные наушники с шумоподавлением и премиальным звуком.",price:24990,category:"audio",image:"images/sony.jpg",inStock:!0,rating:4.9},{id:5,name:"Смартфон Samsung Galaxy S23",description:"Мощный Android-смартфон с камерой высокого разрешения.",price:69990,category:"smartphones",image:"images/s23.jpeg",inStock:!0,rating:4.5},{id:6,name:"Ноутбук MacBook Air M2",description:"Легкий и мощный ноутбук от Apple с чипом M2.",price:119990,category:"laptops",image:"images/macbook.webp",inStock:!1,rating:4.8},{id:7,name:'Телевизор LG OLED 65"',description:"OLED телевизор с идеальным черным цветом и высокой контрастностью.",price:149990,category:"tvs",image:"images/lg.avif",inStock:!0,rating:4.9},{id:8,name:"Колонка JBL Flip 6",description:"Портативная Bluetooth колонка с мощным звуком и защитой от воды.",price:8990,category:"audio",image:"images/jbl.jpg",inStock:!0,rating:4.4}]}setupEventListeners(){const e=document.getElementById("category-filter"),t=document.getElementById("price-filter"),r=document.getElementById("reset-filters");e&&e.addEventListener("change",(e=>{this.currentCategory=e.target.value,this.applyFilters()})),t&&t.addEventListener("change",(e=>{this.currentPriceRange=e.target.value,this.applyFilters()})),r&&r.addEventListener("click",(()=>{this.resetFilters()}));const n=document.querySelector(".search-form");n&&n.addEventListener("submit",(e=>{e.preventDefault(),this.handleSearch()}));const i=document.getElementById("search-input");if(i){let e;i.addEventListener("input",(t=>{clearTimeout(e),e=setTimeout((()=>{this.searchQuery=t.target.value.toLowerCase().trim(),this.applyFilters()}),300)}))}}applyFilters(){console.log("Применение фильтров:",{category:this.currentCategory,priceRange:this.currentPriceRange,searchQuery:this.searchQuery}),this.filteredProducts=this.products.filter((e=>{const t="all"===this.currentCategory||e.category===this.currentCategory;let r=!0;"all"!==this.currentPriceRange&&(r=this.checkPriceRange(e.price,this.currentPriceRange));const n=!this.searchQuery||e.name.toLowerCase().includes(this.searchQuery)||e.description.toLowerCase().includes(this.searchQuery),i=t&&r&&n;return console.log(`Товар "${e.name}": категория=${t}, цена=${r}, поиск=${n}, итог=${i}`),i})),console.log("Отфильтровано товаров:",this.filteredProducts.length),this.renderProducts()}checkPriceRange(e,t){switch(t){case"0-10000":return e>=0&&e<=1e4;case"10000-30000":return e>=1e4&&e<=3e4;case"30000-50000":return e>=3e4&&e<=5e4;case"50000+":return e>=5e4;default:return!0}}resetFilters(){const e=document.getElementById("category-filter"),t=document.getElementById("price-filter"),r=document.getElementById("search-input");e&&(e.value="all"),t&&(t.value="all"),r&&(r.value=""),this.currentCategory="all",this.currentPriceRange="all",this.searchQuery="",this.applyFilters()}handleSearch(){const e=document.getElementById("search-input");if(e){this.searchQuery=e.value.toLowerCase().trim(),this.applyFilters();const t=document.getElementById("catalog");t&&t.scrollIntoView({behavior:"smooth"})}}renderProducts(){const e=document.getElementById("products-container");e?(e.innerHTML="",0!==this.filteredProducts.length?this.filteredProducts.forEach((t=>{const r=this.createProductCard(t);e.appendChild(r)})):e.innerHTML='\n                <div class="text-center" style="grid-column: 1 / -1; padding: 3rem;">\n                    <h3>Товары не найдены</h3>\n                    <p>Попробуйте изменить параметры фильтрации или поисковый запрос</p>\n                    <button class="button button--primary mt-2" onclick="productManager.resetFilters()">\n                        Сбросить фильтры\n                    </button>\n                </div>\n            '):console.error("Контейнер продуктов не найден")}createProductCard(e){const t=document.createElement("div");t.className="product-card",t.innerHTML=`\n            <img src="${e.image}" alt="${e.name}" class="product-card__image" \n                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IiMzMzMiPlByb2R1Y3Q8L3RleHQ+PC9zdmc+'">\n            <div class="product-card__content">\n                <h3 class="product-card__title">${e.name}</h3>\n                <p class="product-card__description">${e.description}</p>\n                <div class="product-card__meta">\n                    <span class="product-rating">⭐ ${e.rating}</span>\n                    ${e.inStock?'<span class="product-stock in-stock">В наличии</span>':'<span class="product-stock out-of-stock">Нет в наличии</span>'}\n                </div>\n                <div class="product-card__price">${this.formatPrice(e.price)}</div>\n                <div class="product-card__actions">\n                    <button class="button button--primary" data-id="${e.id}" \n                            ${e.inStock?"":"disabled"}>\n                        ${e.inStock?"В корзину":"Нет в наличии"}\n                    </button>\n                    <button class="button button--secondary">Подробнее</button>\n                </div>\n            </div>\n        `;const r=t.querySelector(".button--primary");e.inStock&&r.addEventListener("click",(()=>{"undefined"!=typeof cartManager&&cartManager.addToCart(e)}));return t.querySelector(".button--secondary").addEventListener("click",(()=>{this.showProductDetails(e)})),t}showProductDetails(e){alert(`Детали товара: ${e.name}\n\nЦена: ${this.formatPrice(e.price)}\n\n${e.description}`)}formatPrice(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(e)}getProductById(e){return this.products.find((t=>t.id===e))}}document.addEventListener("DOMContentLoaded",(()=>{try{window.productManager=new ProductManager,console.log("Менеджер товаров успешно инициализирован")}catch(e){console.error("Ошибка при инициализации менеджера товаров:",e)}document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const t=this.getAttribute("href");if("#"===t)return;const r=document.querySelector(t);r&&(r.scrollIntoView({behavior:"smooth",block:"start"}),document.querySelectorAll(".nav-list__link").forEach((e=>{e.classList.remove("nav-list__link--current")})),this.classList.add("nav-list__link--current"))}))}));const e=document.getElementById("feedback-form");e&&e.addEventListener("submit",(t=>{t.preventDefault();document.getElementById("feedback-name").value,document.getElementById("feedback-email").value,document.getElementById("feedback-message").value;alert("Спасибо за ваше сообщение! Мы свяжемся с вами в ближайшее время."),e.reset()}))}));document.addEventListener("DOMContentLoaded",(function(){const e=sessionStorage.getItem("searchQuery");if(e&&window.productManager){const t=document.getElementById("search-input");t&&(t.value=e,window.productManager.searchQuery=e.toLowerCase(),window.productManager.applyFilters()),sessionStorage.removeItem("searchQuery")}}));